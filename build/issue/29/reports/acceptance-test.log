+ssh-keygen -t rsa -N '' -C '' -f /home/travis/.ssh/id_rsa
Generating public/private rsa key pair.
Your identification has been saved in /home/travis/.ssh/id_rsa.
Your public key has been saved in /home/travis/.ssh/id_rsa.pub.
The key fingerprint is:
5d:6b:a0:0d:3a:05:90:16:c7:74:52:9a:6b:ef:80:54 
The key's randomart image is:
+--[ RSA 2048]----+
|    o*=.o        |
|    o..*         |
|   .  E o . .    |
|     . + = o .   |
|    . = S o o    |
|   . o o   .     |
|    . . .        |
|       o         |
|        .        |
+-----------------+
+ssh-keygen -t rsa -N pass_phrase -C '' -f /home/travis/.ssh/id_rsa_pass
Generating public/private rsa key pair.
Your identification has been saved in /home/travis/.ssh/id_rsa_pass.
Your public key has been saved in /home/travis/.ssh/id_rsa_pass.pub.
The key fingerprint is:
10:b2:94:b8:99:9d:a8:2c:2c:78:09:33:61:9e:2d:9b 
The key's randomart image is:
+--[ RSA 2048]----+
|   .o..          |
|.....o .         |
|o.o*...          |
|++=.o  .         |
|+=+.    S        |
|=Eo              |
|o.               |
|                 |
|                 |
+-----------------+
+tee -a /home/travis/.ssh/authorized_keys
ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDn0BMVpSleYWjRQUsSC1SMh9VPWy3uNYSesTnY7g52AvZB3xIcu+Ld83v/oMPulZkwFyabsUBDrR5YtSjwIsCFZnff8DYwAarILLfnQV+BQZJUkUCrZ+IOLjLcqfBr3Zj9m2w0X+Ksd9sNs2ThL2lnNV66/0AoT2T8QIrGPBCaczz9BEJNJ1bXdLOqm7uOYDuivsaZwsVtMcTDsVjLzxF/Dp1uIqXvEiEbPeQSg8gb1t4K2i5vNB15KluxMlbomCAqJpe8cvRMSFK4y+OhocWFNVvQtA8pXbxaDZewp25SzlJ6aVErXAT5cYeyknTj7UM+FHwYVjbH/qkswLAXxnQR 
+ssh -o StrictHostKeyChecking=no -o UserKnownHostsFile=/home/travis/.ssh/known_hosts -o HashKnownHosts=no -o HostKeyAlgorithms=ssh-rsa -i /home/travis/.ssh/id_rsa localhost true
Warning: Permanently added 'localhost' (RSA) to the list of known hosts.
+grep localhost /home/travis/.ssh/known_hosts
localhost ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCgoJbx8TFml7geHLSu8YFE4dAYAD4IX+ExqoawY9+VIxogVnCE4siyO1lvE3jiuTm8oI8r4Vcib9FBl43aWY7xQEuZ6kg7sjS75ftqtWupiBJrcWVDEelbzr2qYOtSeX+7Ymd5VkOg/v4u8hPPn6YFV+0BhoShqEEE9APHqySN8NOmR+PhbxgtMGJr4Xsct7BdzsFJPHEc9Xz124O+cuUSoii1YvHsfIp7uorsWPV6xOpXPulj0OEesdw8YXp6UrcqzCZY/jojNEYE4iOX54V3MbgYO9Kbm2pcM5RunSZnUmCKNhIyFCNgu4CP8Fzmv8Bzu133/u6qtpHhqqh560Gt
+mkdir -p build/reports
+./gradlew -i -s -p acceptance-test test aggressiveTest
Starting Build
Settings evaluated using empty settings script.
Projects loaded. Root project using build file '/home/travis/build/int128/gradle-ssh-plugin/acceptance-test/build.gradle'.
Included projects: [root project 'acceptance-test']
Evaluating root project 'acceptance-test' using build file '/home/travis/build/int128/gradle-ssh-plugin/acceptance-test/build.gradle'.
Compiling build file '/home/travis/build/int128/gradle-ssh-plugin/acceptance-test/build.gradle' using StatementExtractingScriptTransformer.
Compiling build file '/home/travis/build/int128/gradle-ssh-plugin/acceptance-test/build.gradle' using BuildScriptTransformer.
Compiling script '/home/travis/build/int128/gradle-ssh-plugin/acceptance-test/features.gradle' using StatementExtractingScriptTransformer.
Compiling script '/home/travis/build/int128/gradle-ssh-plugin/acceptance-test/features.gradle' using BuildScriptTransformer.
Added feature: executing a command
Added feature: filter hosts by role
Added feature: executing commands sequentially
Added feature: each command should have independent environment
Added feature: executing a command with PTY allocation
Added feature: executing commands concurrently
Added feature: handling failure of the remote command
Added feature: handling failure of the remote command in background
Added feature: executing a privileged command by sudo (aggressive test because requires creating an user and setting up sudoers)
Added feature: executing a privileged command by sudo without password (aggressive test because requires creating an user and setting up sudoers)
Added feature: using remote specific identity (aggressive test because requires creating an user and setting up key pair)
Added feature: executing a shell
Added feature: sending files to the remote host and acquiring result files
All projects evaluated.
Selected primary tasks 'test', 'aggressiveTest'
Tasks to be executed: [task ':executeCommand', task ':executeCommandByRole', task ':executeCommandWithPty', task ':executeConcurrently', task ':executeSequentially', task ':executeShell', task ':failureStatus', task ':failureStatusInBackground', task ':setupBuildDir', task ':putAndGetFiles', task ':testEnvironmentOfCommand', task ':test', task ':createUserForSudoNoPassword', task ':executeSudoNoPassword', task ':deleteUserForSudoNoPassword', task ':createUserForSudoWithPassword', task ':executeSudoWithPassword', task ':deleteUserForSudoWithPassword', task ':createUserWithAuthorizedKey', task ':useRemoteSpecificIdentity', task ':deleteUserWithAuthorizedKey', task ':aggressiveTest']
:executeCommand (Thread[main,5,main]) started.
:executeCommand
Executing task ':executeCommand' (up-to-date check took 0.001 secs) due to:
  Task has not declared any outputs.
Execute a command (expr 4766 + 362) with options ([:])
Channel #0 has been opened
5128
Channel #0 has been closed with exit status 0
:executeCommand (Thread[main,5,main]) completed. Took 1.447 secs.
:executeCommandByRole (Thread[main,5,main]) started.
:executeCommandByRole
Executing task ':executeCommandByRole' (up-to-date check took 0.0 secs) due to:
  Task has not declared any outputs.
Execute a command (expr 1280 + 7013) with options ([:])
Channel #1 has been opened
8293
Channel #1 has been closed with exit status 0
:executeCommandByRole (Thread[main,5,main]) completed. Took 0.317 secs.
:executeCommandWithPty (Thread[main,5,main]) started.
:executeCommandWithPty
Executing task ':executeCommandWithPty' (up-to-date check took 0.0 secs) due to:
  Task has not declared any outputs.
Execute a command (env | grep -v SSH_TTY) in background
Channel #2 has been opened
Execute a command (env | grep SSH_TTY) in background
SHELL=/bin/bash
XDG_SESSION_COOKIE=399ba1be7f4982914a3794ad000007da-1392476071.121142-1952308433
SSH_CLIENT=127.0.0.1 49568 22
LC_ALL=en_US.UTF-8
USER=travis
TRAVIS=true
MAIL=/var/mail/travis
PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
PWD=/home/travis
CONTINUOUS_INTEGRATION=true 
JAVA_HOME=/usr/lib/jvm/java-7-oracle
LANG=en_US.UTF-8
SHLVL=1
HOME=/home/travis
CI=true
LOGNAME=travis
LC_CTYPE=en_US.UTF-8
SSH_CONNECTION=127.0.0.1 49568 127.0.0.1 22
DEBIAN_FRONTEND=noninteractive
_=/usr/bin/env
Channel #3 has been opened
Execute a command (env | grep -v SSH_TTY) with options ([:])
Channel #4 has been opened
SSH_TTY=/dev/pts/1
SHELL=/bin/bash
XDG_SESSION_COOKIE=399ba1be7f4982914a3794ad000007da-1392476071.213341-1346669585
SSH_CLIENT=127.0.0.1 49569 22
LC_ALL=en_US.UTF-8
USER=travis
TRAVIS=true
MAIL=/var/mail/travis
PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
PWD=/home/travis
CONTINUOUS_INTEGRATION=true 
JAVA_HOME=/usr/lib/jvm/java-7-oracle
LANG=en_US.UTF-8
SHLVL=1
HOME=/home/travis
CI=true
LOGNAME=travis
LC_CTYPE=en_US.UTF-8
SSH_CONNECTION=127.0.0.1 49569 127.0.0.1 22
DEBIAN_FRONTEND=noninteractive
_=/usr/bin/env
Channel #4 has been closed with exit status 0
Execute a command (env | grep SSH_TTY) with options ([pty:true])
Channel #5 has been opened
SSH_TTY=/dev/pts/1
Channel #5 has been closed with exit status 0
Channel #2 has been closed with exit status 0
Channel #3 has been closed with exit status 0
:executeCommandWithPty (Thread[main,5,main]) completed. Took 0.773 secs.
:executeConcurrently (Thread[main,5,main]) started.
:executeConcurrently
Executing task ':executeConcurrently' (up-to-date check took 0.0 secs) due to:
  Task has not declared any outputs.
Execute a command (sleep 3 && date +%s > /tmp/data-7372) in background
Channel #6 has been opened
Execute a command (sleep 2 && date +%s > /tmp/data-7764) in background
Channel #7 has been opened
Execute a command (sleep 1 && date +%s > /tmp/data-3085) in background
Channel #8 has been opened
Execute a command (date +%s > /tmp/data-8276) in background
Channel #9 has been opened
Channel #9 has been closed with exit status 0
Channel #8 has been closed with exit status 0
Channel #7 has been closed with exit status 0
Channel #6 has been closed with exit status 0
Execute a command (cat /tmp/data-7372 && rm /tmp/data-7372) with options ([:])
Channel #10 has been opened
1392476074
Channel #10 has been closed with exit status 0
Execute a command (cat /tmp/data-7764 && rm /tmp/data-7764) with options ([:])
Channel #11 has been opened
1392476074
Channel #11 has been closed with exit status 0
Execute a command (cat /tmp/data-3085 && rm /tmp/data-3085) with options ([:])
Channel #12 has been opened
1392476073
Channel #12 has been closed with exit status 0
Execute a command (cat /tmp/data-8276 && rm /tmp/data-8276) with options ([:])
Channel #13 has been opened
1392476072
Channel #13 has been closed with exit status 0
:executeConcurrently FAILED
:executeConcurrently (Thread[main,5,main]) completed. Took 4.275 secs.

FAILURE: Build failed with an exception.

* Where:
Script '/home/travis/build/int128/gradle-ssh-plugin/acceptance-test/features.gradle' line: 147

* What went wrong:
Execution failed for task ':executeConcurrently'.
> Assertion failed: 
  
  assert Math.abs((timeA as int) - (timeD as int)) == 3
              |    |             |  |              |
              2    1392476074    2  1392476072     false


* Try:
Run with --debug option to get more log output.

* Exception is:
org.gradle.api.tasks.TaskExecutionException: Execution failed for task ':executeConcurrently'.
	at org.gradle.api.internal.tasks.execution.ExecuteActionsTaskExecuter.executeActions(ExecuteActionsTaskExecuter.java:69)
	at org.gradle.api.internal.tasks.execution.ExecuteActionsTaskExecuter.execute(ExecuteActionsTaskExecuter.java:46)
	at org.gradle.api.internal.tasks.execution.PostExecutionAnalysisTaskExecuter.execute(PostExecutionAnalysisTaskExecuter.java:35)
	at org.gradle.api.internal.tasks.execution.SkipUpToDateTaskExecuter.execute(SkipUpToDateTaskExecuter.java:64)
	at org.gradle.api.internal.tasks.execution.ValidatingTaskExecuter.execute(ValidatingTaskExecuter.java:58)
	at org.gradle.api.internal.tasks.execution.SkipEmptySourceFilesTaskExecuter.execute(SkipEmptySourceFilesTaskExecuter.java:42)
	at org.gradle.api.internal.tasks.execution.SkipTaskWithNoActionsExecuter.execute(SkipTaskWithNoActionsExecuter.java:52)
	at org.gradle.api.internal.tasks.execution.SkipOnlyIfTaskExecuter.execute(SkipOnlyIfTaskExecuter.java:53)
	at org.gradle.api.internal.tasks.execution.ExecuteAtMostOnceTaskExecuter.execute(ExecuteAtMostOnceTaskExecuter.java:43)
	at org.gradle.api.internal.AbstractTask.executeWithoutThrowingTaskFailure(AbstractTask.java:289)
	at org.gradle.execution.taskgraph.AbstractTaskPlanExecutor$TaskExecutorWorker.executeTask(AbstractTaskPlanExecutor.java:79)
	at org.gradle.execution.taskgraph.AbstractTaskPlanExecutor$TaskExecutorWorker.processTask(AbstractTaskPlanExecutor.java:63)
	at org.gradle.execution.taskgraph.AbstractTaskPlanExecutor$TaskExecutorWorker.run(AbstractTaskPlanExecutor.java:51)
	at org.gradle.execution.taskgraph.DefaultTaskPlanExecutor$1.run(DefaultTaskPlanExecutor.java:33)
	at org.gradle.internal.Factories$1.create(Factories.java:22)
	at org.gradle.cache.internal.DefaultCacheAccess.longRunningOperation(DefaultCacheAccess.java:198)
	at org.gradle.cache.internal.DefaultCacheAccess.longRunningOperation(DefaultCacheAccess.java:266)
	at org.gradle.cache.internal.DefaultPersistentDirectoryStore.longRunningOperation(DefaultPersistentDirectoryStore.java:135)
	at org.gradle.api.internal.changedetection.state.DefaultTaskArtifactStateCacheAccess.longRunningOperation(DefaultTaskArtifactStateCacheAccess.java:95)
	at org.gradle.execution.taskgraph.DefaultTaskPlanExecutor.process(DefaultTaskPlanExecutor.java:31)
	at org.gradle.execution.taskgraph.DefaultTaskGraphExecuter.execute(DefaultTaskGraphExecuter.java:86)
	at org.gradle.execution.SelectedTaskExecutionAction.execute(SelectedTaskExecutionAction.java:29)
	at org.gradle.execution.DefaultBuildExecuter.execute(DefaultBuildExecuter.java:61)
	at org.gradle.execution.DefaultBuildExecuter.access$200(DefaultBuildExecuter.java:23)
	at org.gradle.execution.DefaultBuildExecuter$2.proceed(DefaultBuildExecuter.java:67)
	at org.gradle.execution.DryRunBuildExecutionAction.execute(DryRunBuildExecutionAction.java:32)
	at org.gradle.execution.DefaultBuildExecuter.execute(DefaultBuildExecuter.java:61)
	at org.gradle.execution.DefaultBuildExecuter.execute(DefaultBuildExecuter.java:54)
	at org.gradle.initialization.DefaultGradleLauncher.doBuildStages(DefaultGradleLauncher.java:166)
	at org.gradle.initialization.DefaultGradleLauncher.doBuild(DefaultGradleLauncher.java:113)
	at org.gradle.initialization.DefaultGradleLauncher.run(DefaultGradleLauncher.java:81)
	at org.gradle.launcher.exec.InProcessBuildActionExecuter$DefaultBuildController.run(InProcessBuildActionExecuter.java:64)
	at org.gradle.launcher.cli.ExecuteBuildAction.run(ExecuteBuildAction.java:33)
	at org.gradle.launcher.cli.ExecuteBuildAction.run(ExecuteBuildAction.java:24)
	at org.gradle.launcher.exec.InProcessBuildActionExecuter.execute(InProcessBuildActionExecuter.java:35)
	at org.gradle.launcher.exec.InProcessBuildActionExecuter.execute(InProcessBuildActionExecuter.java:26)
	at org.gradle.launcher.cli.RunBuildAction.run(RunBuildAction.java:50)
	at org.gradle.internal.Actions$RunnableActionAdapter.execute(Actions.java:171)
	at org.gradle.launcher.cli.CommandLineActionFactory$ParseAndBuildAction.execute(CommandLineActionFactory.java:201)
	at org.gradle.launcher.cli.CommandLineActionFactory$ParseAndBuildAction.execute(CommandLineActionFactory.java:174)
	at org.gradle.launcher.cli.CommandLineActionFactory$WithLogging.execute(CommandLineActionFactory.java:170)
	at org.gradle.launcher.cli.CommandLineActionFactory$WithLogging.execute(CommandLineActionFactory.java:139)
	at org.gradle.launcher.cli.ExceptionReportingAction.execute(ExceptionReportingAction.java:33)
	at org.gradle.launcher.cli.ExceptionReportingAction.execute(ExceptionReportingAction.java:22)
	at org.gradle.launcher.Main.doAction(Main.java:46)
	at org.gradle.launcher.bootstrap.EntryPoint.run(EntryPoint.java:45)
	at org.gradle.launcher.Main.main(Main.java:37)
	at org.gradle.launcher.bootstrap.ProcessBootstrap.runNoExit(ProcessBootstrap.java:50)
	at org.gradle.launcher.bootstrap.ProcessBootstrap.run(ProcessBootstrap.java:32)
	at org.gradle.launcher.GradleMain.main(GradleMain.java:23)
	at org.gradle.wrapper.BootstrapMainStarter.start(BootstrapMainStarter.java:30)
	at org.gradle.wrapper.WrapperExecutor.execute(WrapperExecutor.java:127)
	at org.gradle.wrapper.GradleWrapperMain.main(GradleWrapperMain.java:58)
Caused by: org.codehaus.groovy.runtime.InvokerInvocationException: Assertion failed: 

assert Math.abs((timeA as int) - (timeD as int)) == 3
            |    |             |  |              |
            2    1392476074    2  1392476072     false

	at org.gradle.api.internal.AbstractTask$ClosureTaskAction.execute(AbstractTask.java:502)
	at org.gradle.api.internal.AbstractTask$ClosureTaskAction.execute(AbstractTask.java:483)
	at org.gradle.api.internal.tasks.execution.ExecuteActionsTaskExecuter.executeAction(ExecuteActionsTaskExecuter.java:80)
	at org.gradle.api.internal.tasks.execution.ExecuteActionsTaskExecuter.executeActions(ExecuteActionsTaskExecuter.java:61)
	... 52 more
Caused by: Assertion failed: 

assert Math.abs((timeA as int) - (timeD as int)) == 3
            |    |             |  |              |
            2    1392476074    2  1392476072     false

	at features_2dnetaj9mji46geq4bf5iho8f$_run_closure14_closure56.doCall(/home/travis/build/int128/gradle-ssh-plugin/acceptance-test/features.gradle:147)
	... 56 more


BUILD FAILED

Total time: 19.369 secs
