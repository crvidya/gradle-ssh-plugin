+ssh-keygen -t rsa -N '' -C '' -f /home/travis/.ssh/id_rsa
Generating public/private rsa key pair.
Your identification has been saved in /home/travis/.ssh/id_rsa.
Your public key has been saved in /home/travis/.ssh/id_rsa.pub.
The key fingerprint is:
b3:a4:54:8a:4d:f9:d1:cf:87:ff:33:98:1b:36:c5:7d 
The key's randomart image is:
+--[ RSA 2048]----+
|                 |
|       . .       |
|      o o .      |
|     + + . o .. .|
|    . + S   + .oE|
|     . o o   o. .|
|      . .    ++  |
|            .oo+ |
|             .. +|
+-----------------+
+ssh-keygen -t rsa -N pass_phrase -C '' -f /home/travis/.ssh/id_rsa_pass
Generating public/private rsa key pair.
Your identification has been saved in /home/travis/.ssh/id_rsa_pass.
Your public key has been saved in /home/travis/.ssh/id_rsa_pass.pub.
The key fingerprint is:
76:17:a8:0f:f9:e0:b0:ef:df:c3:1b:6b:64:9e:a0:f1 
The key's randomart image is:
+--[ RSA 2048]----+
|                 |
|           .     |
|          . .    |
|         o   .   |
|      . S . .    |
|       =.*..o    |
|      . .+o*..   |
|       .. E.*o   |
|       .o...+o   |
+-----------------+
+tee -a /home/travis/.ssh/authorized_keys
ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQC1Bl8AZDH5hqRFaOrgM2SoYPWe+rL7uK3UTKZnHGdI5MLV4x4/XwWkDjuKHjCnv/+MS7GLHD171WMmHrmfxPWNYNPAG7ELoBqrTCAYclemAKjqIYDwgPwdreYL2fanGW3BQZhLv21Q56L0d56jvIs13IKBpE9G8dCidknslngpwZgpl3eEJj7gMdfjhDHrxD/U10Eq3Rq7J2A800btq9rLsR+U+ReoGcxUWYJQY+Gl2VBSNz7Vz9lwFKUwSQ3FlAWq6eqYx/O7LLB/7FGLOA6/+zIncyDu3eTSqEi+fN2blajuv9ZJ2/VKgnECKvzHTHMPioS8HJRMI6ertJJXgMv7 
+ssh -o StrictHostKeyChecking=no -o UserKnownHostsFile=/home/travis/.ssh/known_hosts -o HashKnownHosts=no -o HostKeyAlgorithms=ssh-rsa -i /home/travis/.ssh/id_rsa localhost true
Warning: Permanently added 'localhost' (RSA) to the list of known hosts.
+grep localhost /home/travis/.ssh/known_hosts
localhost ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDvqQe94LNYcBOO9CUCpyclsn8tUqAPg2I+KfiDOhZSxoxfDqJeko8y8GZ+OYwWZkzyGZYjCkBFO2OWXWq9UYzNdbhLz0yMn+UNMq3qzzz0IRi6ntTmr5w5Sqw7KFPcMdxqXr7t55aIsS4RFcqJpwOSWU0JIeMgKjaXbQFqCawR0om/5qsluwkUWbL/xmw7icAfVoIhQsazx547mLgHfFoR0OEqb3loNnJRjgtsSJTLziEpQQG6OcBEZlyLPc962DaZ/mhCYZsc3MvTJAuGdjjSQ9sQDbTrLk1WSvIa2LfQVa7/Gy7yAvVfc7Qy8LvaWjao0PBCYrL9wzGFXYKg2LXh
+mkdir -p build/reports
+./gradlew -i -s -p acceptance-test test aggressiveTest
Starting Build
Settings evaluated using empty settings script.
Projects loaded. Root project using build file '/home/travis/build/int128/gradle-ssh-plugin/acceptance-test/build.gradle'.
Included projects: [root project 'acceptance-test']
Evaluating root project 'acceptance-test' using build file '/home/travis/build/int128/gradle-ssh-plugin/acceptance-test/build.gradle'.
Compiling build file '/home/travis/build/int128/gradle-ssh-plugin/acceptance-test/build.gradle' using StatementExtractingScriptTransformer.
Compiling build file '/home/travis/build/int128/gradle-ssh-plugin/acceptance-test/build.gradle' using BuildScriptTransformer.
Compiling script '/home/travis/build/int128/gradle-ssh-plugin/acceptance-test/features.gradle' using StatementExtractingScriptTransformer.
Compiling script '/home/travis/build/int128/gradle-ssh-plugin/acceptance-test/features.gradle' using BuildScriptTransformer.
Added feature: executing a command
Added feature: filter hosts by role
Added feature: executing commands sequentially
Added feature: each command should have independent environment
Added feature: executing a command with PTY allocation
Added feature: executing commands concurrently
Added feature: handling failure of the remote command
Added feature: handling failure of the remote command in background
Added feature: executing a privileged command by sudo (aggressive test because requires creating an user and setting up sudoers)
Added feature: executing a privileged command by sudo without password (aggressive test because requires creating an user and setting up sudoers)
Added feature: using remote specific identity (aggressive test because requires creating an user and setting up key pair)
Added feature: executing a shell
Added feature: sending files to the remote host and acquiring result files
All projects evaluated.
Selected primary tasks 'test', 'aggressiveTest'
Tasks to be executed: [task ':executeCommand', task ':executeCommandByRole', task ':executeCommandWithPty', task ':executeConcurrently', task ':executeSequentially', task ':executeShell', task ':failureStatus', task ':failureStatusInBackground', task ':setupBuildDir', task ':putAndGetFiles', task ':testEnvironmentOfCommand', task ':test', task ':createUserForSudoNoPassword', task ':executeSudoNoPassword', task ':deleteUserForSudoNoPassword', task ':createUserForSudoWithPassword', task ':executeSudoWithPassword', task ':deleteUserForSudoWithPassword', task ':createUserWithAuthorizedKey', task ':useRemoteSpecificIdentity', task ':deleteUserWithAuthorizedKey', task ':aggressiveTest']
:executeCommand (Thread[main,5,main]) started.
:executeCommand
Executing task ':executeCommand' (up-to-date check took 0.001 secs) due to:
  Task has not declared any outputs.
Execute a command (expr 1584 + 6431) with options ([:])
Channel #0 has been opened
8015
Channel #0 has been closed with exit status 0
:executeCommand (Thread[main,5,main]) completed. Took 1.265 secs.
:executeCommandByRole (Thread[main,5,main]) started.
:executeCommandByRole
Executing task ':executeCommandByRole' (up-to-date check took 0.0 secs) due to:
  Task has not declared any outputs.
Execute a command (expr 5277 + 9048) with options ([:])
Channel #1 has been opened
14325
Channel #1 has been closed with exit status 0
:executeCommandByRole (Thread[main,5,main]) completed. Took 0.307 secs.
:executeCommandWithPty (Thread[main,5,main]) started.
:executeCommandWithPty
Executing task ':executeCommandWithPty' (up-to-date check took 0.0 secs) due to:
  Task has not declared any outputs.
Execute a command (env | grep -v SSH_TTY) in background
Channel #2 has been opened
Execute a command (env | grep SSH_TTY) in background
Channel #3 has been opened
Execute a command (env | grep -v SSH_TTY) with options ([:])
Channel #4 has been opened
SHELL=/bin/bash
XDG_SESSION_COOKIE=399ba1be7f4982914a3794ad000007da-1392553151.414380-1963453261
SSH_CLIENT=127.0.0.1 41182 22
LC_ALL=en_US.UTF-8
USER=travis
TRAVIS=true
MAIL=/var/mail/travis
PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
PWD=/home/travis
CONTINUOUS_INTEGRATION=true 
SHELL=/bin/bash
JAVA_HOME=/usr/lib/jvm/java-7-oracle
XDG_SESSION_COOKIE=399ba1be7f4982914a3794ad000007da-1392553151.496275-1643890642
LANG=en_US.UTF-8
SSH_CLIENT=127.0.0.1 41183 22
SHLVL=1
LC_ALL=en_US.UTF-8
HOME=/home/travis
USER=travis
CI=true
TRAVIS=true
LOGNAME=travis
MAIL=/var/mail/travis
LC_CTYPE=en_US.UTF-8
PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
SSH_CONNECTION=127.0.0.1 41182 127.0.0.1 22
PWD=/home/travis
DEBIAN_FRONTEND=noninteractive
CONTINUOUS_INTEGRATION=true 
_=/usr/bin/env
JAVA_HOME=/usr/lib/jvm/java-7-oracle
LANG=en_US.UTF-8
SHLVL=1
HOME=/home/travis
CI=true
LOGNAME=travis
LC_CTYPE=en_US.UTF-8
SSH_CONNECTION=127.0.0.1 41183 127.0.0.1 22
DEBIAN_FRONTEND=noninteractive
SSH_TTY=/dev/pts/1
_=/usr/bin/env
Channel #4 has been closed with exit status 0
Execute a command (env | grep SSH_TTY) with options ([pty:true])
Channel #5 has been opened
SSH_TTY=/dev/pts/1
Channel #5 has been closed with exit status 0
Channel #2 has been closed with exit status 0
Channel #3 has been closed with exit status 0
:executeCommandWithPty (Thread[main,5,main]) completed. Took 0.696 secs.
:executeConcurrently (Thread[main,5,main]) started.
:executeConcurrently
Executing task ':executeConcurrently' (up-to-date check took 0.0 secs) due to:
  Task has not declared any outputs.
Execute a command (sleep 3 && date +%s > /tmp/data-4045) in background
Channel #6 has been opened
Execute a command (sleep 2 && date +%s > /tmp/data-564) in background
Channel #7 has been opened
Execute a command (sleep 1 && date +%s > /tmp/data-2227) in background
Channel #8 has been opened
Execute a command (date +%s > /tmp/data-3436) in background
Channel #9 has been opened
Channel #9 has been closed with exit status 0
Channel #8 has been closed with exit status 0
Channel #7 has been closed with exit status 0
Channel #6 has been closed with exit status 0
Execute a command (cat /tmp/data-4045 && rm /tmp/data-4045) with options ([:])
Channel #10 has been opened
1392553155
Channel #10 has been closed with exit status 0
Execute a command (cat /tmp/data-564 && rm /tmp/data-564) with options ([:])
Channel #11 has been opened
1392553154
Channel #11 has been closed with exit status 0
Execute a command (cat /tmp/data-2227 && rm /tmp/data-2227) with options ([:])
Channel #12 has been opened
1392553153
Channel #12 has been closed with exit status 0
Execute a command (cat /tmp/data-3436 && rm /tmp/data-3436) with options ([:])
Channel #13 has been opened
1392553152
Channel #13 has been closed with exit status 0
:executeConcurrently (Thread[main,5,main]) completed. Took 4.237 secs.
:executeSequentially (Thread[main,5,main]) started.
:executeSequentially
Executing task ':executeSequentially' (up-to-date check took 0.0 secs) due to:
  Task has not declared any outputs.
Execute a command (expr 6551 + 2273 > /tmp/data-3836) with options ([:])
Channel #14 has been opened
Channel #14 has been closed with exit status 0
Execute a command (expr 6551 + `cat /tmp/data-3836` > /tmp/data-6758) with options ([:])
Channel #15 has been opened
Channel #15 has been closed with exit status 0
Execute a command (cat /tmp/data-3836 && rm /tmp/data-3836) with options ([:])
Channel #16 has been opened
8824
Channel #16 has been closed with exit status 0
Execute a command (cat /tmp/data-6758 && rm /tmp/data-6758) with options ([:])
Channel #17 has been opened
15375
Channel #17 has been closed with exit status 0
:executeSequentially (Thread[main,5,main]) completed. Took 0.909 secs.
:executeShell (Thread[main,5,main]) started.
:executeShell
Executing task ':executeShell' (up-to-date check took 0.0 secs) due to:
  Task has not declared any outputs.
Execute a shell with options ([:])
Channel #18 has been opened
Last login: Sun Feb 16 12:19:11 2014 from localhost.localdomain

travis@testing-worker-linux-8-1-2081-linux-6-18975288:~$ 
exit 0

logout
Channel #18 has been closed with exit status 0
:executeShell (Thread[main,5,main]) completed. Took 0.748 secs.
:failureStatus (Thread[main,5,main]) started.
:failureStatus
Executing task ':failureStatus' (up-to-date check took 0.0 secs) due to:
  Task has not declared any outputs.
Execute a command (exit 1) with options ([:])
Channel #19 has been opened
Channel #19 has been closed with exit status 1
:failureStatus (Thread[main,5,main]) completed. Took 0.313 secs.
:failureStatusInBackground (Thread[main,5,main]) started.
:failureStatusInBackground
Executing task ':failureStatusInBackground' (up-to-date check took 0.0 secs) due to:
  Task has not declared any outputs.
Execute a command (exit 1) in background
Channel #20 has been opened
Channel #20 has been closed with exit status 1
:failureStatusInBackground (Thread[main,5,main]) completed. Took 0.299 secs.
:setupBuildDir (Thread[main,5,main]) started.
:setupBuildDir
Executing task ':setupBuildDir' (up-to-date check took 0.0 secs) due to:
  Task has not declared any outputs.
:setupBuildDir (Thread[main,5,main]) completed. Took 0.005 secs.
:putAndGetFiles (Thread[main,5,main]) started.
:putAndGetFiles
Executing task ':putAndGetFiles' (up-to-date check took 0.0 secs) due to:
  Task has not declared any outputs.
Put a local file (/home/travis/build/int128/gradle-ssh-plugin/acceptance-test/build/local-8541) to remote (/tmp/data-5392)
Channel #21 has been opened
Channel #21 has been closed with exit status -1
Put a local file (/home/travis/build/int128/gradle-ssh-plugin/acceptance-test/build/local-8843) to remote (/tmp/data-3671)
Channel #22 has been opened
Channel #22 has been closed with exit status -1
Execute a command (expr `cat /tmp/data-5392` + `cat /tmp/data-3671` > /tmp/data-1306) with options ([:])
Channel #23 has been opened
Channel #23 has been closed with exit status 0
Execute a command (expr `cat /tmp/data-5392` - `cat /tmp/data-3671` > /tmp/data-1735) with options ([:])
Channel #24 has been opened
Channel #24 has been closed with exit status 0
Get a remote file (/tmp/data-1306) to local (/home/travis/build/int128/gradle-ssh-plugin/acceptance-test/build/local-906)
Channel #25 has been opened
Channel #25 has been closed with exit status -1
Get a remote file (/tmp/data-1735) to local (/home/travis/build/int128/gradle-ssh-plugin/acceptance-test/build/local-1445)
Channel #26 has been opened
Channel #26 has been closed with exit status -1
Execute a command (rm -v /tmp/data-5392 /tmp/data-3671 /tmp/data-1306 /tmp/data-1735) with options ([:])
Channel #27 has been opened
removed `/tmp/data-5392'
removed `/tmp/data-3671'
removed `/tmp/data-1306'
removed `/tmp/data-1735'
Channel #27 has been closed with exit status 0
:putAndGetFiles (Thread[main,5,main]) completed. Took 0.81 secs.
:testEnvironmentOfCommand (Thread[main,5,main]) started.
:testEnvironmentOfCommand
Executing task ':testEnvironmentOfCommand' (up-to-date check took 0.0 secs) due to:
  Task has not declared any outputs.
Execute a command (export testdata=dummy) with options ([:])
Channel #28 has been opened
Channel #28 has been closed with exit status 0
Execute a command (echo "testdata is $testdata") with options ([:])
Channel #29 has been opened
testdata is 
Channel #29 has been closed with exit status 0
:testEnvironmentOfCommand (Thread[main,5,main]) completed. Took 0.5 secs.
:test (Thread[main,5,main]) started.
:test
Skipping task ':test' as it has no actions.
:test (Thread[main,5,main]) completed. Took 0.003 secs.
:createUserForSudoNoPassword (Thread[main,5,main]) started.
:createUserForSudoNoPassword
Executing task ':createUserForSudoNoPassword' (up-to-date check took 0.0 secs) due to:
  Task has not declared any outputs.
Execute a command (sudo useradd -m user1963n) with options ([:])
Channel #30 has been opened
Channel #30 has been closed with exit status 0
Execute a command (sudo passwd user1963n) with options ([:])
Channel #31 has been opened
Enter new UNIX password: 
Retype new UNIX password: 
passwd: password updated successfully
Channel #31 has been closed with exit status 0
Execute a command (echo 'user1963n ALL=(ALL) NOPASSWD: ALL' > /tmp/user1963n) with options ([:])
Channel #32 has been opened
Channel #32 has been closed with exit status 0
Execute a command (sudo chmod 440 /tmp/user1963n) with options ([:])
Channel #33 has been opened
Channel #33 has been closed with exit status 0
Execute a command (sudo chown 0.0 /tmp/user1963n) with options ([:])
Channel #34 has been opened
Channel #34 has been closed with exit status 0
Execute a command (sudo mv /tmp/user1963n /etc/sudoers.d) with options ([:])
Channel #35 has been opened
Channel #35 has been closed with exit status 0
:createUserForSudoNoPassword (Thread[main,5,main]) completed. Took 1.318 secs.
:executeSudoNoPassword (Thread[main,5,main]) started.
:executeSudoNoPassword
Executing task ':executeSudoNoPassword' (up-to-date check took 0.0 secs) due to:
  Task has not declared any outputs.
Execute a command (whoami) with sudo support and options ([pty:true])
Execute a command (sudo -S -p '51eb1538-67e9-4633-9bfc-073cb5e896bf' whoami) with options ([pty:true])
Channel #36 has been opened
root
Channel #36 has been closed with exit status 0
:executeSudoNoPassword (Thread[main,5,main]) completed. Took 0.29 secs.
:deleteUserForSudoNoPassword (Thread[main,5,main]) started.
:deleteUserForSudoNoPassword
Executing task ':deleteUserForSudoNoPassword' (up-to-date check took 0.0 secs) due to:
  Task has not declared any outputs.
Execute a command (sudo rm -v /etc/sudoers.d/user1963n) with options ([:])
Channel #37 has been opened
removed `/etc/sudoers.d/user1963n'
Channel #37 has been closed with exit status 0
Execute a command (sudo userdel -r user1963n) with options ([:])
Channel #38 has been opened
Channel #38 has been closed with exit status 0
:deleteUserForSudoNoPassword (Thread[main,5,main]) completed. Took 0.502 secs.
:createUserForSudoWithPassword (Thread[main,5,main]) started.
:createUserForSudoWithPassword
Executing task ':createUserForSudoWithPassword' (up-to-date check took 0.0 secs) due to:
  Task has not declared any outputs.
Execute a command (sudo useradd -m user3324p) with options ([:])
Channel #39 has been opened
Channel #39 has been closed with exit status 0
Execute a command (sudo passwd user3324p) with options ([:])
Channel #40 has been opened
Enter new UNIX password: 
Retype new UNIX password: 
passwd: password updated successfully
Channel #40 has been closed with exit status 0
Execute a command (echo 'user3324p ALL=(ALL) ALL' > /tmp/user3324p) with options ([:])
Channel #41 has been opened
Channel #41 has been closed with exit status 0
Execute a command (sudo chmod 440 /tmp/user3324p) with options ([:])
Channel #42 has been opened
Channel #42 has been closed with exit status 0
Execute a command (sudo chown 0.0 /tmp/user3324p) with options ([:])
Channel #43 has been opened
Channel #43 has been closed with exit status 0
Execute a command (sudo mv /tmp/user3324p /etc/sudoers.d) with options ([:])
Channel #44 has been opened
Channel #44 has been closed with exit status 0
:createUserForSudoWithPassword (Thread[main,5,main]) completed. Took 1.311 secs.
:executeSudoWithPassword (Thread[main,5,main]) started.
:executeSudoWithPassword
Executing task ':executeSudoWithPassword' (up-to-date check took 0.0 secs) due to:
  Task has not declared any outputs.
Execute a command (whoami) with sudo support and options ([pty:true])
Execute a command (sudo -S -p '9cecb05e-8b6e-447f-a6df-d074951098f0' whoami) with options ([pty:true])
Channel #45 has been opened
Sending password for sudo authentication on channel #45
9cecb05e-8b6e-447f-a6df-d074951098f0

root
Channel #45 has been closed with exit status 0
:executeSudoWithPassword (Thread[main,5,main]) completed. Took 0.26 secs.
:deleteUserForSudoWithPassword (Thread[main,5,main]) started.
:deleteUserForSudoWithPassword
Executing task ':deleteUserForSudoWithPassword' (up-to-date check took 0.0 secs) due to:
  Task has not declared any outputs.
Execute a command (sudo rm -v /etc/sudoers.d/user3324p) with options ([:])
Channel #46 has been opened
removed `/etc/sudoers.d/user3324p'
Channel #46 has been closed with exit status 0
Execute a command (sudo userdel -r user3324p) with options ([:])
Channel #47 has been opened
Channel #47 has been closed with exit status 0
:deleteUserForSudoWithPassword (Thread[main,5,main]) completed. Took 0.491 secs.
:createUserWithAuthorizedKey (Thread[main,5,main]) started.
:createUserWithAuthorizedKey
Executing task ':createUserWithAuthorizedKey' (up-to-date check took 0.0 secs) due to:
  Task has not declared any outputs.
Execute a command (sudo useradd -m user3214n) with options ([:])
Channel #48 has been opened
Channel #48 has been closed with exit status 0
Execute a command (sudo -u user3214n mkdir ~user3214n/.ssh) with options ([:])
Channel #49 has been opened
Channel #49 has been closed with exit status 0
Execute a command (sudo -u user3214n tee ~user3214n/.ssh/authorized_keys < ~/.ssh/id_rsa_pass.pub) with options ([:])
Channel #50 has been opened
ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDE74DEorsOznbif79F9D5K40XswcdswybyqiHdoUT1sxF/VUwPPeMi7D+2mbJLuyWSm15tbNEFV6bFy0I+/2G6TRIadsAzyLpkYrICPf1Go+o7A3IS7TnYgvKpMeof0pq/7K2Bg7XvN4SWOCInfdn7TnNRiDpFTXxpJchqudcT5n6naEp2WvCz2TvxIyYbiw4pKKyfiYrVH9blOZIFpEOIeE66f6dMX0S/n+WKEFbsf6pA7wv6nmdh9sbGhr8F5O2xrJuaVDFKAh6KQ6yrcpsNg+mUApbOyKQZBGqMkVmxmQJpkZQp9UHSFAnQC4BvBNpLxuXW8WtOxCGvb425ETn1 
Channel #50 has been closed with exit status 0
:createUserWithAuthorizedKey (Thread[main,5,main]) completed. Took 0.695 secs.
:useRemoteSpecificIdentity (Thread[main,5,main]) started.
:useRemoteSpecificIdentity
Executing task ':useRemoteSpecificIdentity' (up-to-date check took 0.0 secs) due to:
  Task has not declared any outputs.
Execute a command (whoami) with options ([:])
Channel #51 has been opened
user3214n
Channel #51 has been closed with exit status 0
:useRemoteSpecificIdentity (Thread[main,5,main]) completed. Took 0.292 secs.
:deleteUserWithAuthorizedKey (Thread[main,5,main]) started.
:deleteUserWithAuthorizedKey
Executing task ':deleteUserWithAuthorizedKey' (up-to-date check took 0.0 secs) due to:
  Task has not declared any outputs.
Execute a command (sudo userdel -r user3214n) with options ([:])
Channel #52 has been opened
Channel #52 has been closed with exit status 0
:deleteUserWithAuthorizedKey (Thread[main,5,main]) completed. Took 0.287 secs.
:aggressiveTest (Thread[main,5,main]) started.
:aggressiveTest
Skipping task ':aggressiveTest' as it has no actions.
:aggressiveTest (Thread[main,5,main]) completed. Took 0.001 secs.

BUILD SUCCESSFUL

Total time: 27.261 secs
