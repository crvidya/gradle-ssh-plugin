+ssh-keygen -t rsa -N '' -C '' -f /home/travis/.ssh/id_rsa
Generating public/private rsa key pair.
Your identification has been saved in /home/travis/.ssh/id_rsa.
Your public key has been saved in /home/travis/.ssh/id_rsa.pub.
The key fingerprint is:
0a:84:32:62:b6:05:39:6b:14:8c:77:6a:20:c0:a4:a5 
The key's randomart image is:
+--[ RSA 2048]----+
|B++              |
|=Oo..            |
|E=++.            |
|+==.             |
|.o  .   S        |
|     . .         |
|      .          |
|                 |
|                 |
+-----------------+
+ssh-keygen -t rsa -N pass_phrase -C '' -f /home/travis/.ssh/id_rsa_pass
Generating public/private rsa key pair.
Your identification has been saved in /home/travis/.ssh/id_rsa_pass.
Your public key has been saved in /home/travis/.ssh/id_rsa_pass.pub.
The key fingerprint is:
50:74:ee:22:d6:30:83:0c:e3:8f:ce:28:49:7f:93:10 
The key's randomart image is:
+--[ RSA 2048]----+
|  o    .o .      |
| . + . . o       |
|  .Eo =   .      |
|   o.  * .       |
| .... o S .      |
|.=. .... .       |
|+ o. +           |
|.   . .          |
|                 |
+-----------------+
+tee -a /home/travis/.ssh/authorized_keys
ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDWuxymq1QpCBrou4Lz0dShrPD6DDhJltgY+W5ijFdTycGZks4/KKmfPInc80Oua4A1hG00+NpZpEQSz9ym52v/dniN3M2wDpG4hEFv246FBsgDR0waj573kkLRs82UxWAri4TjASlhxWTLpCvxvQz2WMW9XJ66jqsWOq5ZMSEtXXlTCWSTSHcts52eZZ5CWLD/qEGOWeItVwr34yAtq8yqXsyA7sgJ8ZBVoiXJ48w0qczdrGJHekqHVOcaGAkgqIjXz4wau4I2WLOd0yT9sxLsy57qGMKDIqtXUSwZeD6reTy3DjW6V9XzmZW3ZB4U959SmBvfwZlodqcEWTaTenjf 
+ssh -o StrictHostKeyChecking=no -o UserKnownHostsFile=/home/travis/.ssh/known_hosts -o HashKnownHosts=no -o HostKeyAlgorithms=ssh-rsa -i /home/travis/.ssh/id_rsa localhost true
Warning: Permanently added 'localhost' (RSA) to the list of known hosts.
+grep localhost /home/travis/.ssh/known_hosts
localhost ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDETU/oCF8puHnKQuaBPFNGLdpW8RItsDbBxeDEwifc/Vbwk0lzoJsbchLP4f+0D1xcDZux7tqFdVM/czU529EstF4rQhC0ae1SeEulQWeu1UoLiSp1aeNfmD5X2FGOkXEHH8xormSfDeq9UMd1udJLL9N29iocYSGQQ2dKYf3jVnpYq+RFuEP0dsq6v9gqYkoSqCYuuVzaChlO47A3eRMJJHfA9F+kHcFOWmlsi8eLf4oPi8rU6MCFmhBiaGfKU1zUImCchsJzkymS+o7WN08uC/NDvh9kseJqopds7z50sEyeonLQaoJxNWjFI0HoLt5jgHbbdm7IXUJNXGEuil85
+mkdir -p build/reports
+./gradlew -i -s -p acceptance-test test aggressiveTest
Starting Build
Settings evaluated using empty settings script.
Projects loaded. Root project using build file '/home/travis/build/int128/gradle-ssh-plugin/acceptance-test/build.gradle'.
Included projects: [root project 'acceptance-test']
Evaluating root project 'acceptance-test' using build file '/home/travis/build/int128/gradle-ssh-plugin/acceptance-test/build.gradle'.
Compiling build file '/home/travis/build/int128/gradle-ssh-plugin/acceptance-test/build.gradle' using StatementExtractingScriptTransformer.
Compiling build file '/home/travis/build/int128/gradle-ssh-plugin/acceptance-test/build.gradle' using BuildScriptTransformer.
Compiling script '/home/travis/build/int128/gradle-ssh-plugin/acceptance-test/features.gradle' using StatementExtractingScriptTransformer.
Compiling script '/home/travis/build/int128/gradle-ssh-plugin/acceptance-test/features.gradle' using BuildScriptTransformer.
Added feature: executing a command
Added feature: filter hosts by role
Added feature: executing commands sequentially
Added feature: each command should have independent environment
Added feature: executing a command with PTY allocation
Added feature: executing commands concurrently
Added feature: handling failure of the remote command
Added feature: handling failure of the remote command in background
Added feature: executing a privileged command by sudo (aggressive test because requires creating an user and setting up sudoers)
Added feature: executing a privileged command by sudo without password (aggressive test because requires creating an user and setting up sudoers)
Added feature: using remote specific identity (aggressive test because requires creating an user and setting up key pair)
Added feature: executing a shell
Added feature: sending files to the remote host and acquiring result files
All projects evaluated.
Selected primary tasks 'test', 'aggressiveTest'
Tasks to be executed: [task ':executeCommand', task ':executeCommandByRole', task ':executeCommandWithPty', task ':executeConcurrently', task ':executeSequentially', task ':executeShell', task ':failureStatus', task ':failureStatusInBackground', task ':setupBuildDir', task ':putAndGetFiles', task ':testEnvironmentOfCommand', task ':test', task ':createUserForSudoNoPassword', task ':executeSudoNoPassword', task ':deleteUserForSudoNoPassword', task ':createUserForSudoWithPassword', task ':executeSudoWithPassword', task ':deleteUserForSudoWithPassword', task ':createUserWithAuthorizedKey', task ':useRemoteSpecificIdentity', task ':deleteUserWithAuthorizedKey', task ':aggressiveTest']
:executeCommand (Thread[main,5,main]) started.
:executeCommand
Executing task ':executeCommand' (up-to-date check took 0.0 secs) due to:
  Task has not declared any outputs.
Execute a command (expr 8332 + 2205) with options ([:])
Channel #0 has been opened
10537
Channel #0 has been closed with exit status 0
:executeCommand (Thread[main,5,main]) completed. Took 1.208 secs.
:executeCommandByRole (Thread[main,5,main]) started.
:executeCommandByRole
Executing task ':executeCommandByRole' (up-to-date check took 0.001 secs) due to:
  Task has not declared any outputs.
Execute a command (expr 3091 + 9402) with options ([:])
Channel #1 has been opened
12493
Channel #1 has been closed with exit status 0
:executeCommandByRole (Thread[main,5,main]) completed. Took 0.328 secs.
:executeCommandWithPty (Thread[main,5,main]) started.
:executeCommandWithPty
Executing task ':executeCommandWithPty' (up-to-date check took 0.0 secs) due to:
  Task has not declared any outputs.
Execute a command (env | grep -v SSH_TTY) in background
Channel #2 has been opened
Execute a command (env | grep SSH_TTY) in background
Channel #3 has been opened
Execute a command (env | grep -v SSH_TTY) with options ([:])
Channel #4 has been opened
SHELL=/bin/bash
XDG_SESSION_COOKIE=399ba1be7f4982914a3794ad000007da-1392640294.78274-646420273
SSH_CLIENT=127.0.0.1 53849 22
LC_ALL=en_US.UTF-8
USER=travis
TRAVIS=true
MAIL=/var/mail/travis
PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
PWD=/home/travis
CONTINUOUS_INTEGRATION=true 
JAVA_HOME=/usr/lib/jvm/java-7-oracle
LANG=en_US.UTF-8
SHLVL=1
HOME=/home/travis
CI=true
LOGNAME=travis
LC_CTYPE=en_US.UTF-8
SSH_CONNECTION=127.0.0.1 53849 127.0.0.1 22
DEBIAN_FRONTEND=noninteractive
_=/usr/bin/env
SHELL=/bin/bash
XDG_SESSION_COOKIE=399ba1be7f4982914a3794ad000007da-1392640294.170622-2016655108
SSH_CLIENT=127.0.0.1 53850 22
LC_ALL=en_US.UTF-8
SSH_TTY=/dev/pts/1
USER=travis
TRAVIS=true
MAIL=/var/mail/travis
PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
PWD=/home/travis
CONTINUOUS_INTEGRATION=true 
JAVA_HOME=/usr/lib/jvm/java-7-oracle
LANG=en_US.UTF-8
SHLVL=1
HOME=/home/travis
CI=true
LOGNAME=travis
LC_CTYPE=en_US.UTF-8
SSH_CONNECTION=127.0.0.1 53850 127.0.0.1 22
DEBIAN_FRONTEND=noninteractive
_=/usr/bin/env
Channel #4 has been closed with exit status 0
Execute a command (env | grep SSH_TTY) with options ([pty:true])
Channel #5 has been opened
SSH_TTY=/dev/pts/1
Channel #5 has been closed with exit status 0
Channel #2 has been closed with exit status 0
Channel #3 has been closed with exit status 0
:executeCommandWithPty (Thread[main,5,main]) completed. Took 0.728 secs.
:executeConcurrently (Thread[main,5,main]) started.
:executeConcurrently
Executing task ':executeConcurrently' (up-to-date check took 0.0 secs) due to:
  Task has not declared any outputs.
Execute a command (sleep 3 && date +%s > /tmp/data-8020) in background
Channel #6 has been opened
Execute a command (sleep 2 && date +%s > /tmp/data-1008) in background
Channel #7 has been opened
Execute a command (sleep 1 && date +%s > /tmp/data-18) in background
Channel #8 has been opened
Execute a command (date +%s > /tmp/data-5788) in background
Channel #9 has been opened
Channel #9 has been closed with exit status 0
Channel #8 has been closed with exit status 0
Channel #7 has been closed with exit status 0
Channel #6 has been closed with exit status 0
Execute a command (cat /tmp/data-8020 && rm /tmp/data-8020) with options ([:])
Channel #10 has been opened
1392640297
Channel #10 has been closed with exit status 0
Execute a command (cat /tmp/data-1008 && rm /tmp/data-1008) with options ([:])
Channel #11 has been opened
1392640296
Channel #11 has been closed with exit status 0
Execute a command (cat /tmp/data-18 && rm /tmp/data-18) with options ([:])
Channel #12 has been opened
1392640295
Channel #12 has been closed with exit status 0
Execute a command (cat /tmp/data-5788 && rm /tmp/data-5788) with options ([:])
Channel #13 has been opened
1392640295
Channel #13 has been closed with exit status 0
:executeConcurrently FAILED
:executeConcurrently (Thread[main,5,main]) completed. Took 4.395 secs.

FAILURE: Build failed with an exception.

* Where:
Script '/home/travis/build/int128/gradle-ssh-plugin/acceptance-test/features.gradle' line: 147

* What went wrong:
Execution failed for task ':executeConcurrently'.
> Assertion failed: 
  
  assert Math.abs((timeA as int) - (timeD as int)) == 3
              |    |             |  |              |
              2    1392640297    2  1392640295     false


* Try:
Run with --debug option to get more log output.

* Exception is:
org.gradle.api.tasks.TaskExecutionException: Execution failed for task ':executeConcurrently'.
	at org.gradle.api.internal.tasks.execution.ExecuteActionsTaskExecuter.executeActions(ExecuteActionsTaskExecuter.java:69)
	at org.gradle.api.internal.tasks.execution.ExecuteActionsTaskExecuter.execute(ExecuteActionsTaskExecuter.java:46)
	at org.gradle.api.internal.tasks.execution.PostExecutionAnalysisTaskExecuter.execute(PostExecutionAnalysisTaskExecuter.java:35)
	at org.gradle.api.internal.tasks.execution.SkipUpToDateTaskExecuter.execute(SkipUpToDateTaskExecuter.java:64)
	at org.gradle.api.internal.tasks.execution.ValidatingTaskExecuter.execute(ValidatingTaskExecuter.java:58)
	at org.gradle.api.internal.tasks.execution.SkipEmptySourceFilesTaskExecuter.execute(SkipEmptySourceFilesTaskExecuter.java:42)
	at org.gradle.api.internal.tasks.execution.SkipTaskWithNoActionsExecuter.execute(SkipTaskWithNoActionsExecuter.java:52)
	at org.gradle.api.internal.tasks.execution.SkipOnlyIfTaskExecuter.execute(SkipOnlyIfTaskExecuter.java:53)
	at org.gradle.api.internal.tasks.execution.ExecuteAtMostOnceTaskExecuter.execute(ExecuteAtMostOnceTaskExecuter.java:43)
	at org.gradle.api.internal.AbstractTask.executeWithoutThrowingTaskFailure(AbstractTask.java:289)
	at org.gradle.execution.taskgraph.AbstractTaskPlanExecutor$TaskExecutorWorker.executeTask(AbstractTaskPlanExecutor.java:79)
	at org.gradle.execution.taskgraph.AbstractTaskPlanExecutor$TaskExecutorWorker.processTask(AbstractTaskPlanExecutor.java:63)
	at org.gradle.execution.taskgraph.AbstractTaskPlanExecutor$TaskExecutorWorker.run(AbstractTaskPlanExecutor.java:51)
	at org.gradle.execution.taskgraph.DefaultTaskPlanExecutor$1.run(DefaultTaskPlanExecutor.java:33)
	at org.gradle.internal.Factories$1.create(Factories.java:22)
	at org.gradle.cache.internal.DefaultCacheAccess.longRunningOperation(DefaultCacheAccess.java:198)
	at org.gradle.cache.internal.DefaultCacheAccess.longRunningOperation(DefaultCacheAccess.java:266)
	at org.gradle.cache.internal.DefaultPersistentDirectoryStore.longRunningOperation(DefaultPersistentDirectoryStore.java:135)
	at org.gradle.api.internal.changedetection.state.DefaultTaskArtifactStateCacheAccess.longRunningOperation(DefaultTaskArtifactStateCacheAccess.java:95)
	at org.gradle.execution.taskgraph.DefaultTaskPlanExecutor.process(DefaultTaskPlanExecutor.java:31)
	at org.gradle.execution.taskgraph.DefaultTaskGraphExecuter.execute(DefaultTaskGraphExecuter.java:86)
	at org.gradle.execution.SelectedTaskExecutionAction.execute(SelectedTaskExecutionAction.java:29)
	at org.gradle.execution.DefaultBuildExecuter.execute(DefaultBuildExecuter.java:61)
	at org.gradle.execution.DefaultBuildExecuter.access$200(DefaultBuildExecuter.java:23)
	at org.gradle.execution.DefaultBuildExecuter$2.proceed(DefaultBuildExecuter.java:67)
	at org.gradle.execution.DryRunBuildExecutionAction.execute(DryRunBuildExecutionAction.java:32)
	at org.gradle.execution.DefaultBuildExecuter.execute(DefaultBuildExecuter.java:61)
	at org.gradle.execution.DefaultBuildExecuter.execute(DefaultBuildExecuter.java:54)
	at org.gradle.initialization.DefaultGradleLauncher.doBuildStages(DefaultGradleLauncher.java:166)
	at org.gradle.initialization.DefaultGradleLauncher.doBuild(DefaultGradleLauncher.java:113)
	at org.gradle.initialization.DefaultGradleLauncher.run(DefaultGradleLauncher.java:81)
	at org.gradle.launcher.exec.InProcessBuildActionExecuter$DefaultBuildController.run(InProcessBuildActionExecuter.java:64)
	at org.gradle.launcher.cli.ExecuteBuildAction.run(ExecuteBuildAction.java:33)
	at org.gradle.launcher.cli.ExecuteBuildAction.run(ExecuteBuildAction.java:24)
	at org.gradle.launcher.exec.InProcessBuildActionExecuter.execute(InProcessBuildActionExecuter.java:35)
	at org.gradle.launcher.exec.InProcessBuildActionExecuter.execute(InProcessBuildActionExecuter.java:26)
	at org.gradle.launcher.cli.RunBuildAction.run(RunBuildAction.java:50)
	at org.gradle.internal.Actions$RunnableActionAdapter.execute(Actions.java:171)
	at org.gradle.launcher.cli.CommandLineActionFactory$ParseAndBuildAction.execute(CommandLineActionFactory.java:201)
	at org.gradle.launcher.cli.CommandLineActionFactory$ParseAndBuildAction.execute(CommandLineActionFactory.java:174)
	at org.gradle.launcher.cli.CommandLineActionFactory$WithLogging.execute(CommandLineActionFactory.java:170)
	at org.gradle.launcher.cli.CommandLineActionFactory$WithLogging.execute(CommandLineActionFactory.java:139)
	at org.gradle.launcher.cli.ExceptionReportingAction.execute(ExceptionReportingAction.java:33)
	at org.gradle.launcher.cli.ExceptionReportingAction.execute(ExceptionReportingAction.java:22)
	at org.gradle.launcher.Main.doAction(Main.java:46)
	at org.gradle.launcher.bootstrap.EntryPoint.run(EntryPoint.java:45)
	at org.gradle.launcher.Main.main(Main.java:37)
	at org.gradle.launcher.bootstrap.ProcessBootstrap.runNoExit(ProcessBootstrap.java:50)
	at org.gradle.launcher.bootstrap.ProcessBootstrap.run(ProcessBootstrap.java:32)
	at org.gradle.launcher.GradleMain.main(GradleMain.java:23)
	at org.gradle.wrapper.BootstrapMainStarter.start(BootstrapMainStarter.java:30)
	at org.gradle.wrapper.WrapperExecutor.execute(WrapperExecutor.java:127)
	at org.gradle.wrapper.GradleWrapperMain.main(GradleWrapperMain.java:58)
Caused by: org.codehaus.groovy.runtime.InvokerInvocationException: Assertion failed: 

assert Math.abs((timeA as int) - (timeD as int)) == 3
            |    |             |  |              |
            2    1392640297    2  1392640295     false

	at org.gradle.api.internal.AbstractTask$ClosureTaskAction.execute(AbstractTask.java:502)
	at org.gradle.api.internal.AbstractTask$ClosureTaskAction.execute(AbstractTask.java:483)
	at org.gradle.api.internal.tasks.execution.ExecuteActionsTaskExecuter.executeAction(ExecuteActionsTaskExecuter.java:80)
	at org.gradle.api.internal.tasks.execution.ExecuteActionsTaskExecuter.executeActions(ExecuteActionsTaskExecuter.java:61)
	... 52 more
Caused by: Assertion failed: 

assert Math.abs((timeA as int) - (timeD as int)) == 3
            |    |             |  |              |
            2    1392640297    2  1392640295     false

	at features_2dnetaj9mji46geq4bf5iho8f$_run_closure14_closure56.doCall(/home/travis/build/int128/gradle-ssh-plugin/acceptance-test/features.gradle:147)
	... 56 more


BUILD FAILED

Total time: 20.778 secs
